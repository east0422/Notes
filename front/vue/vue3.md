# vue3

### watch与watchEffect
  - watch默认非即时，即时响应需加immediate: true，对象深度监听需加deep: true。调用watch返回方法可停止监听。需明确指定侦听的数据，可以监听一个或多个数据，甚至可以监听计算属性或深度侦听对象。
  - watchEffect用于创建即时执行的侦听器。它会立即执行一次传入的函数，同时会自动追踪函数内部使用到的响应式数据，无需像watch一样需手动指定侦听的具体数据，当这些数据发生变化时，会再次执行该函数。返回一个无需手动停止的函数，当组件卸载时Vue会自动停止对响应式数据的追踪，也可以显式调用返回值主动停止侦听。flush参数指定侦听器执行时机，默认pre先执行侦听器再更新dom，所有默认侦听器中获取的dom变量值是先前的，可修改为post先修改dom后执行侦听器。
  - watch监视reactive定义的响应式数据时默认自动开启了深度监视(deep为true)，并且该深度监视不可通过配置项{deep:false}关闭(deep配置项只会对属性对象生效)。
  - watch监视ref定义的[引用类型]数据：直接写数据名，监视的是源数据的[地址值(堆/栈内存的关系)]，若想深层监视对象内部的数据，则需要手动开启深度监视。修改数据中某一个属性时会出现newValue和oldValue都是同一个新值的情况，因为它们是指向同一个源对象地址(数组同理：如果直接通过数组下标索引修改某个值则newValue和oldValue也会是同一个新值的情况)。若修改了整个ref.value的值，newValue则是新的值，oldValue则是旧的值，这是因为相当于从新分配了一块内存空间，新旧数据已经不指向同一块源对象地址了。